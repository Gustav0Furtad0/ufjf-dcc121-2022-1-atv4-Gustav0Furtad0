<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Problema do Fazendeiro - ATV4</title>
    <link rel="stylesheet" href="./css/style.css">
</head>
<body>
    <div class="rio">
        <div class="margem" id="maresquerda">
            <div class="produto"  id="ovelha">
                
            </div>
            <div class="produto" id="alface">
                
            </div>
            <div class="produto" id="lobo">
                  
            </div>
        </div>

        <div class="margem" id="mardireita">

        </div>

        <div id="fazendeiro">
            <div id="bau">
                
            </div>
        </div>
        
    </div>

    <script>
        const fazendeiro = document.querySelector("#fazendeiro");
        const ovelha = document.querySelector("#ovelha");
        const lobo = document.querySelector("#lobo");
        const alface = document.querySelector("#alface");
        const maresquerda = document.querySelector("#maresquerda");
        const mardireita = document.querySelector("#mardireita");
        const bau = document.querySelector("#bau")

        function move(elemento, inicio, fim) {
            if (inicio < fim) {
                let i = inicio + 1;
                setTimeout(() => {
                    elemento.style.left = i + 'px';
                    move(elemento, i, fim);
                }, 4);
            } else if (inicio > fim) {
                let i = inicio - 1;
                setTimeout(() => {
                    elemento.style.left = i + 'px';
                    move(elemento, i, fim);
                }, 4);
            }
        }

        fazendeiro.addEventListener("dblclick", () => {;
            let fazend = fazendeiro.getBoundingClientRect();
            let maresq = maresquerda.getBoundingClientRect();
            let mardir = mardireita.getBoundingClientRect();
            if (fazend.left == maresq.right) {
                console.log("Zarpando");
                move(fazendeiro, fazend.left, (mardir.left - 450));
                fazendeiro.style.transform = 'scaleX(1)';
            } else if (fazend.right == mardir.left) {
                move(fazendeiro, fazend.left, maresq.right);
                fazendeiro.style.transform = 'scaleX(-1)';
                console.log("Zarpando");
            } 
        });

        function entraSaiBarco(elemento) {
            let fazend = fazendeiro.getBoundingClientRect();
            let maresq = maresquerda.getBoundingClientRect();
            let mardir = mardireita.getBoundingClientRect();
            let copia = elemento.outerHTML;
            if(elemento.parentNode == maresquerda && fazend.left == maresq.right) {
                console.log("Produto entrou no barco pela esquerda")
                elemento.remove();
                bau.innerHTML = copia;
            } else if(elemento.parentNode == mardireita && fazend.left == (mardir.left - 450)) {
                console.log("Produto entrou no barco pela direita")
                elemento.remove();
                
            } else {
                console.log("Lobo no baÃº")
            }
        }

        function margens() {
            console.log(fazendeiro.getBoundingClientRect());
            console.log(maresquerda.getBoundingClientRect());
            console.log(mardireita.getBoundingClientRect());
        }

        

        bau.addEventListener("click", () => {
            console.log("click bau")
        });

        lobo.addEventListener("click", () => {
            console.log('click lobo')
            entraSaiBarco(lobo);
        });

        ovelha.addEventListener("click", () => {
            entraSaiBarco(ovelha);
        });

        alface.addEventListener("click", () => {
            entraSaiBarco(alface);
        });
        
    </script>
</body>
</html>